<!DOCTYPE html>
<html>
<head>
    <title>Met Paintings ASCII Art</title>
    <style>
        body { padding: 20px; max-width: 1200px; margin: 0 auto; background: #f5f5f5; }
        .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .artwork { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        img { width: 100%; height: auto; border-radius: 4px; }
        pre { 
            font-family: monospace;
            font-size: 6px;
            line-height: 6px;
            background: black;
            color: white;
            padding: 10px;
            white-space: pre;
            border-radius: 4px;
            margin-top: 10px;
        }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <button onclick="loadRandomPainting()">Load Random Painting</button>
    <div id="gallery" class="gallery"></div>

    <script>
        async function loadRandomPainting() {
            try {
                const response = await fetch('https://collectionapi.metmuseum.org/public/collection/v1/search?hasImages=true&q=painting&medium=Paintings');
                const data = await response.json();
                const randomId = data.objectIDs[Math.floor(Math.random() * data.objectIDs.length)];
                
                const artworkResponse = await fetch(`https://collectionapi.metmuseum.org/public/collection/v1/objects/${randomId}`);
                const artwork = await artworkResponse.json();

                if (artwork.primaryImage) {
                    const div = document.createElement('div');
                    div.className = 'artwork';
                    div.innerHTML = `
                        <h3>${artwork.title}</h3>
                        <p>${artwork.artistDisplayName}</p>
                        <img src="${artwork.primaryImage}" crossorigin="anonymous" alt="${artwork.title}">
                        <pre>Converting to ASCII...</pre>
                    `;
                    document.getElementById('gallery').appendChild(div);

                    const img = div.querySelector('img');
                    const pre = div.querySelector('pre');
                    img.onload = () => pre.textContent = convertToAscii(img);
                }
            } catch (error) {
                console.error('Error loading artwork:', error);
            }
        }

        function convertToAscii(img) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 60;
            canvas.height = Math.floor(60 * (img.height / img.width));
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            const pixels = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
            const chars = '@#8&OLlv+;:,. ';
            let ascii = '';
            
            for (let y = 0; y < canvas.height; y += 2) {
                for (let x = 0; x < canvas.width; x += 2) {
                    const idx = (y * canvas.width + x) * 4;
                    const brightness = (pixels[idx] + pixels[idx + 1] + pixels[idx + 2]) / 3;
                    ascii += chars[Math.floor(brightness / 256 * chars.length)];
                }
                ascii += '\n';
            }
            return ascii;
        }

        loadRandomPainting();
    </script>
</body>
</html>
